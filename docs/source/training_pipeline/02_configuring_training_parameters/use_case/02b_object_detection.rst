.. include:: /include/substitution.rst

****************
Object Detection
****************

* :ref:`detection-config-files-mainconfig`
* :ref:`detection-config-files-datamodule`
* :ref:`detection-config-files-trainer`

.. _detection-config-files-mainconfig:

Main Config
===========

Config File: ``peekingduck/training/configs/config.yaml``

+---------------------------------------+-----------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Key                                   | Value                                               | Description                                                                                                                                                |
+=======================================+=====================================================+============================================================================================================================================================+
| :mod:`project_name`                   | “your_project_name”                                 | your_project_name will be used as your output folder                                                                                                       |
+---------------------------------------+-----------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+
| :mod:`defaults`                       |                                                     |                                                                                                                                                            |
+--+------------------------------------+-----------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+
|  | :mod:`use_case`                    | detection                                           | Type of the model to be trained and used.                                                                                                                  |
+--+------------------------------------+-----------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+
|  | :mod:`data_module`                 | :grey:`${use_case}`                                 |                                                                                                                                                            |
+--+------------------------------------+-----------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+
|  | :grey:`model`                      | :grey:`${use_case}`                                 |                                                                                                                                                            |
+--+------------------------------------+-----------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+
|  | :grey:`trainer`                    | :grey:`${use_case}`                                 |                                                                                                                                                            |
+--+------------------------------------+-----------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+
|  | :grey:`callbacks`                  | :grey:`${use_case}`                                 |                                                                                                                                                            |
+--+------------------------------------+-----------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+
|  | :grey:`metrics`                    | :grey:`${use_case}`                                 |                                                                                                                                                            |
+--+------------------------------------+-----------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+
|  | :grey:`model_analysis`             | :grey:`${use_case}`                                 |                                                                                                                                                            |
+--+------------------------------------+-----------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+
|  | :grey:`stores`                     | :grey:`${use_case}`                                 |                                                                                                                                                            |
+--+------------------------------------+-----------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+
|  | :grey:`override hydra/job_logging` | :grey:`custom`                                      |                                                                                                                                                            |
+--+------------------------------------+-----------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+
| :grey:`hydra`                         |                                                     |                                                                                                                                                            |
+--+------------------------------------+-----------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+
|  | :grey:`run`                        |                                                     |                                                                                                                                                            |
+--+-----------+------------------------+-----------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+
|  |           | :grey:`dir`            | :grey:`outputs/${project_name}/${stores.unique_id}` |                                                                                                                                                            |
+--+-----------+------------------------+-----------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+
|  | :grey:`sweep`                      |                                                     |                                                                                                                                                            |
+--+-----------+------------------------+-----------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+
|  |           | :grey:`dir`            | :grey:`outputs/${project_name}/${stores.unique_id}` |                                                                                                                                                            |
+--+-----------+------------------------+-----------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+
|  |           | :grey:`subdir`         | :grey:`${hydra.job.num}`                            |                                                                                                                                                            |
+--+-----------+------------------------+-----------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+

----------

.. _detection-config-files-datamodule:

Data Module
===========

Dataset and dataset format.
Config File : ``peekingduck/training/configs/data_module/detection.yaml``

+---------------------------------------------------------+----------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Key                                                     | Value                                              | Description                                                                                                                                                                                                                                                                                             |
+=========================================================+====================================================+========+================================================================================================================================================================================================================================================================================================+
| :mod:`dataset_format`                                   |:mod:`coco`                                         | "coco" | 'voc'                                                                                                                                                                                                                                                                                          |
+--------------------------+------------------------------+----------------------------------------------------+--------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| :grey:`defaults`         |                              |                                                    |                                                                                                                                                                                                                                                                                                         |
+--------------------------+------------------------------+----------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                          | :mod:`dataset`               | :mod:`fashion`                                     |                                                                                                                                                                                                                                                                                                         |
+--------------------------+------------------------------+----------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+



----------


.. _detection-config-files-trainer:

Trainer
=======


| The trainer class will make use of these configs.
| Config File : ``peekingduck/training/configs/trainer/detection.yaml``


.. tabs::

   .. tab:: General
      
      Global trainer parameters.

      +--------------------------------------------------------------------------------------------+--------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------+
      | Key                                                                                        | Value                                                  | Description                                                                                                                                        |
      +============================================================================================+========================================================+====================================================================================================================================================+
      | :grey:`yolox`                                                                              |                                                        |                                                                                                                                                    |
      +------------------------------------+-------------------------------------------------------+--------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------+
      |                                    | :mod:`epochs`                                         | 10                                                     | Number of epochs to train                                                                                                                          |
      +------------------------------------+-------------------------------------------------------+--------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------+
      |                                    | :mod:`name`                                           | null                                                   |                                                                                                                                                    |
      +------------------------------------+-------------------------------------------------------+--------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------+
      |                                    | :mod:`resume`                                         | False                                                  |                                                                                                                                                    |
      +------------------------------------+-------------------------------------------------------+--------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------+
      |                                    | :mod:`devices`                                        | 1                                                      |                                                                                                                                                    |
      +------------------------------------+-------------------------------------------------------+--------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------+
      |                                    | :mod:`batch_size`                                     | 8                                                      |                                                                                                                                                    |
      +------------------------------------+-------------------------------------------------------+--------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------+
      |                                    | :mod:`max_epoch`                                      | 10                                                     |                                                                                                                                                    |
      +------------------------------------+-------------------------------------------------------+--------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------+
      |                                    | :mod:`fp16`                                           | True                                                   |                                                                                                                                                    |
      +------------------------------------+-------------------------------------------------------+--------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------+
      |                                    | :grey:`occupy`                                        | null                                                   |                                                                                                                                                    |
      +------------------------------------+-------------------------------------------------------+--------------------------------------------------------+-----------+-----------+-----------+-----------+--------------+-------------------------------------------------------------------------------------+
      |                                    | :mod:`model`                                          | :mod:`yolox_s`                                         | "yolox_s" | "yolox_m" | "yolox_l" | "yolox_x" | "yolox_nano" | "yolox_tiny"                                                                        |
      +------------------------------------+-------------------------------------------------------+--------------------------------------------------------+-----------+-----------+-----------+-----------+--------------+-------------------------------------------------------------------------------------+
      |                                    | :mod:`ckpt`                                           | null                                                   |                                                                                                                                                    |
      +------------------------------------+-------------------------------------------------------+--------------------------------------------------------+---------------+------------------------------------------------------------------------------------------------------------------------------------+
      |                                    | :mod:`logger`                                         | tensorboard                                            | "tensorboard" | "wandb"                                                                                                                            |
      +------------------------------------+-------------------------------------------------------+--------------------------------------------------------+---------------+------------------------------------------------------------------------------------------------------------------------------------+
      |                                    | :grey:`cache`                                         | null                                                   | Flag for checking if debug is set to True or False. Reference directly from the main config file.                                                  |
      +------------------------------------+-------------------------------------------------------+--------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------+
      |                                    | :grey:`dist_url`                                      | null                                                   | When debug is set to True, this value will be used for training.                                                                                   |
      +------------------------------------+-------------------------------------------------------+--------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------+
      |                                    | :grey:`num_machines`                                  | 1                                                      | Used in initializing PyTorch metrics. Values can be: 'binary', 'multiclass' or 'multilabel'. Default value references from dataset config file.    |
      +------------------------------------+-------------------------------------------------------+--------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------+
      |                                    | :grey:`machine_rank`                                  | null                                                   |                                                                                                                                                    |
      +------------------------------------+-------------------------------------------------------+--------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------+
      |                                    | :grey:`dist_backend`                                  | null                                                   |                                                                                                                                                    |
      +------------------------------------+-------------------------------------------------------+--------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------+
      |                                    | :mod:`output_dir`                                     | './peekingduck/training/outputs'                       |                                                                                                                                                    |
      +------------------------------------+-------------------------------------------------------+--------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------+
      |                                    | :grey:`seed`                                          | :grey:`${use_case.random_state}`                       | Random seed. Default value will reference directly from the main config file.                                                                      |
      +------------------------------------+-------------------------------------------------------+--------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------+
