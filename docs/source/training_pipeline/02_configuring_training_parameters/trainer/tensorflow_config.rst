
| The trainer class will make use of these configs.
| Config File : ``peekingduck/training/configs/trainer/classification.yaml``

.. tabs::

   .. tab:: General 

      Global trainer parameters

      +-----------------------------------------------------------------+-----------------------------------------------------------------+------------------------------------------------------------------------------------------------------------+
      | Key                                                             | Value                                                           | Description                                                                                                |
      +=================================================================+=================================================================+============================================================================================================+
      | :mod:`global_train_params`                                      |                                                                 |                                                                                                            |
      +------------------------------+----------------------------------+-----------------------------------------------------------------+------------------------------------------------------------------------------------------------------------+
      |                              | :grey:`manual_seed`              | :grey:`${random_state}`                                         | Random seed. Default value will reference directly from the main config file.                              |
      +------------------------------+----------------------------------+-----------------------------------------------------------------+------------------------------------------------------------------------------------------------------------+
      |                              | :mod:`epochs`                    | 10                                                              | Number of epochs to train                                                                                  |
      +------------------------------+----------------------------------+-----------------------------------------------------------------+------------------------------------------------------------------------------------------------------------+
      |                              | :grey:`debug`                    | :grey:`${debug}`                                                | Flag for checking if debug is set to True or False. Reference directly from the main config file.          |
      +------------------------------+----------------------------------+-----------------------------------------------------------------+------------------------------------------------------------------------------------------------------------+
      |                              | :mod:`debug_epochs`              | 3                                                               | When debug is set to True, this value will be used for training.                                           |
      +------------------------------+----------------------------------+-----------------------------------------------------------------+------------------------------------------------------------------------------------------------------------+

   .. tab:: Optimizer

      These parameters will be used for initializing the optimizer. Implemented 
      using the `tf.keras.optimizers <https://keras.io/api/optimizers/>`_ 
      package. Refer to `this documentation <https://keras.io/api/optimizers/>`_ 
      for alternatives. Below is the default values using the Adam optimizer.
      

      Note that the learning rate parameter is not specified here but will refer 
      to the scheduler config file instead.

      +--------------------------------------------------------------------------------------------+------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Key                                                                                        | Value                  | Description                                                                                                                                                                                                               |
      +============================================================================================+========================+===========================================================================================================================================================================================================================+
      | :mod:`optimizer_params`                                                                    |                        |                                                                                                                                                                                                                           |
      +--------------------------+-----------------------------------------------------------------+------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      |                          | :mod:`optimizer`                                                | "Adam"                 |                                                                                                                                                                                                                           |
      +--------------------------+-----------------------------------------------------------------+------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      |                          | :mod:`optimizer_params`                                         |                        |                                                                                                                                                                                                                           |
      +--------------------------+---------------------------------+-------------------------------+------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      |                          |                                 | :mod:`beta_1`                 | 0.9                    | A float value or a constant float tensor, or a callable that takes no arguments and returns the actual value to use. The exponential decay rate for the 1st moment estimates. Defaults to 0.9.                            |
      +--------------------------+---------------------------------+-------------------------------+------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      |                          |                                 | :mod:`beta_2`                 | 0.999                  | A float value or a constant float tensor, or a callable that takes no arguments and returns the actual value to use. The exponential decay rate for the 2nd moment estimates. Defaults to 0.999.                          |
      +--------------------------+---------------------------------+-------------------------------+------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      |                          |                                 | :mod:`epsilon`                | 0.0000007              | epsilon: A small constant for numerical stability. This epsilon is "epsilon hat" in the Kingma and Ba paper (in the formula just before Section 2.1), not the epsilon in Algorithm 1 of the paper. Defaults to 7e-7.      |
      +--------------------------+---------------------------------+-------------------------------+------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      |                          |                                 | :mod:`name`                   | "Adam"                 | name: String. The name to use for momentum accumulator weights created by the optimizer.                                                                                                                                  |
      +--------------------------+---------------------------------+-------------------------------+------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      |                          | :mod:`finetune_learning_rate`                                   | 1e-5                   | Learning rate used for re-initializing optimizer during fine-tuning.                                                                                                                                                      |
      +--------------------------+-----------------------------------------------------------------+------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+


   .. tab:: Scheduler

      These parameters will be used for initializing the scheduler. Implemented 
      using the `tf.keras.optimizers.schedules <https://www.tensorflow.org/
      api_docs/python/tf/keras/optimizers/schedules>`_ package. Refer to 
      `TensorFlow Learning Rate Schedule <https://www.tensorflow.org/api_docs/
      python/tf/keras/optimizers/schedules>`_ for scheduler choices. Scheduler 
      is defaulted to null with a base learning rate of 1e-5.

      +----------------------------------------------------------------------------------+-----------------+-----------------------------+
      | Key                                                                              | Value           | Description                 |
      +==================================================================================+=================+=============================+
      | :mod:`lr_schedule_params`                                                        |                 |                             |
      +------------------------------+---------------------------------------------------+-----------------+-----------------------------+
      |                              | :mod:`schedule`                                   | null            |                             |
      +------------------------------+---------------------------------------------------+-----------------+-----------------------------+
      |                              | :mod:`schedule_params`                            |                 |                             |
      +------------------------------+--------------------------+------------------------+-----------------+-----------------------------+
      |                              |                          | :mod:`learning_rate`   | 1e-5            |                             |
      +------------------------------+--------------------------+------------------------+-----------------+-----------------------------+

      Any of the schedulers listed in the `tf.keras.optimizers.schedules 
      <https://www.tensorflow.org/api_docs/python/tf/keras/optimizers/
      schedules>`_ package can be used. Below is an example using the 
      CosineDecayRestarts scheduler:

      +------------------------------------------------------------------------------------------------+-----------------------------+-----------------------------+
      | Key                                                                                            | Value                       | Description                 |
      +================================================================================================+=============================+=============================+
      | :mod:`lr_schedule_params`                                                                      |                             |                             |
      +------------------------------+-----------------------------------------------------------------+-----------------------------+-----------------------------+
      |                              | :mod:`schedule`                                                 | "CosineDecayRestarts"       |                             |
      +------------------------------+-----------------------------------------------------------------+-----------------------------+-----------------------------+
      |                              | :mod:`schedule_params`                                          |                             |                             |
      +------------------------------+----------------------------+------------------------------------+-----------------------------+-----------------------------+
      |                              |                            | :mod:`initial_learning_rate`       | 0.003                       |                             |
      +------------------------------+----------------------------+------------------------------------+-----------------------------+-----------------------------+
      |                              |                            | :mod:`first_decay_steps`           | 10                          |                             |
      +------------------------------+----------------------------+------------------------------------+-----------------------------+-----------------------------+
      |                              |                            | :mod:`t_mul`                       | 20                          |                             |
      +------------------------------+----------------------------+------------------------------------+-----------------------------+-----------------------------+
      |                              |                            | :mod:`m_mul`                       | 1.0                         |                             |
      +------------------------------+----------------------------+------------------------------------+-----------------------------+-----------------------------+
      |                              |                            | :mod:`alpha`                       | 0.0                         |                             |
      +------------------------------+----------------------------+------------------------------------+-----------------------------+-----------------------------+


   .. tab:: Loss

      Refer to `TensorFlow Loss Functions <https://www.tensorflow.org/api_docs/
      python/tf/keras/losses>`_ for more details and alternatives. The training 
      pipeline defaults to using CategoricalCrossentropy as the loss function.

      +----------------------------------------------------------------------------------+---------------------------------+-----------------------------------------------------------------------------------------------------------------------------+
      | Key                                                                              | Value                           | Description                                                                                                                 |
      +==================================================================================+=================================+=============================================================================================================================+
      | :mod:`loss_params`                                                               |                                 |                                                                                                                             |
      +------------------------------+---------------------------------------------------+---------------------------------+-----------------------------------------------------------------------------------------------------------------------------+
      |                              | :mod:`loss_func`                                  | "CategoricalCrossentropy"       | Computes the cross entropy loss between the labels and predictions.                                                         |
      +------------------------------+---------------------------------------------------+---------------------------------+-----------------------------------------------------------------------------------------------------------------------------+
      |                              | :mod:`loss_params`                                |                                 |                                                                                                                             |
      +------------------------------+--------------------------+------------------------+---------------------------------+-----------------------------------------------------------------------------------------------------------------------------+
      |                              |                          | :mod:`from_logits`     | False                           | Whether y_pred is expected to be a logits tensor. By default, we assume that y_pred encodes a probability distribution.     |
      +------------------------------+--------------------------+------------------------+---------------------------------+-----------------------------------------------------------------------------------------------------------------------------+

